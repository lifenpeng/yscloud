
<div class="container-fluid version-detail publish-stream-detail version_publish" ng-show="!file_control.show_file_history && !file_control.show_file_compare && !control.show_fold_compare">
    <div ng-if="!control.loading">
        <!--头部-->
        <div class="row version-detail-header-container">
            <div class="col-sm-4 font_sise_big">
                <div class="version_busys_img"></div>
                <span class="version_span version-yellow-color">{{one_pub.business_cn_name}}({{one_pub.version_num}})</span>
            </div>
            <div class="col-sm-3 version_font_small">
                <div class="version-common-icon version-num-icon version-margin-top-9"></div>
                <span class="version_time_span">当前版本</span>
                <span class="version_time_span">{{one_pub.version_num}}</span>
            </div>
            <div class="col-sm-3 version_font_small">
                <div class="version-common-icon version-time-icon version-margin-top-9"></div>
                <span class="version_time_span">变更时间</span>
                <span class="version_time_span">{{one_pub.modify_bk_date}}  {{one_pub.modify_bk_time}}</span>
            </div>
            <div class="col-sm-2 text-right">
                 <span class="version-back-btn version-margin-top-9" ng-click="backPubStreamList()">
                    <span class="fa fa-reply"></span>返回
                </span>
            </div>
        </div>
        <!--左侧-版本流-->
        <div class="left-vresion-flow">
            <div class="no-publish-flow-font" ng-show="goData.publish_data.length == 0">
                暂无发布流
            </div>
            <div class="publish-stream-font-position" ng-show="goData.publish_data.length != 0">发布流</div>
            <div class="angle top-angle-position" ng-show="goData.publish_data.length != 0">
                <div class="proj-line" ng-style="projLineStyle()"></div>
                <div class="hollow-md-circle top-circle-position" ng-show="flow_control.show_broken_line">
                    <div class="solid-xs-circle"></div>
                    <div class="left-arrow-position">
                        <div class="angleL left-angle-position"></div>
                        <div class="angleLA left-angle-inner-position"></div>
                        <div class="left-angle-width"></div>
                    </div>
                </div>
                <div class="hollow-md-circle"  ng-style="endHollowLind()" ng-show="flow_control.show_broken_line">
                    <div class="end-circle-container">
                        <div class="angleR right-arrow-position"></div>
                        <div class="angleRA right-angle-inner-position"></div>
                        <div class="right-angle-width"></div>
                    </div>
                </div>
                <div class="hollow-line" ng-style="hollowHeight()" ng-show="flow_control.show_broken_line">
                    <div class="hollow-xs-circle" ng-repeat="proj in goData.real_project_data"  ng-style="projCircleStyle($index)" ng-click="viewPrePubVersion($index)">
                        <div class="checked-version proj-checked-xs-circle" ng-show="proj.is_checked"></div>
                        <div class="wait-exe-proj-style" ng-if="proj.sys_publish_status != 3">
                            {{proj.project_name}}
                        </div>
                        <div class="running-proj-container" ng-if="proj.sys_publish_status == 3">
                            <span class="rotate-img run-img vertical-middle"></span>
                            <span class="vertical-middle">{{proj.project_name}}</span>
                        </div>
                    </div>
                </div>
                <div ng-repeat="pub_version in goData.publish_data"  ng-style="publishCircleStyle($index)" >
                    <div class="hollow-bg-circle version-num-lg-circle-position" ng-click="changeVersion($index)">
                        <div class="checked-version" ng-show="pub_version.is_checked"></div>
                        <div class="version-num-position">{{pub_version.publish_version_number}}</div>
                        <div class="version-publish-time-position">{{pub_version.date_time.replace('/-/g','.').substring(0.16)}}</div>
                    </div>
                </div>
            </div>
        </div>
        <!--右侧-版本信息-->
        <div class="row right-vresion-info">
            <div class="col-sm-12 version-container-bg-color">
                <!--版本头部基本信息-->
                <div class="row version-info-header" ng-if="!control.pre_pub_flag">
                    <div class="col-sm-12" style="float: left;">
                        <div class="version_font_small version_width ver_pe_percent">
                            <div class="version_show_img" title="版本号"></div>
                            <span class="version-icon-span version_font_important over_hidden" style="max-width: 50px;margin-top: 10px;" title="版本号{{one_pub.version_num}}">{{one_pub.version_num}}</span>
                        </div>
                        <div class="version_font_small version_width ver_pe_percent">
                            <div class="version-common-icon version-proj-icon" title="项目名"></div>
                            <span class="version-icon-span over_hidden" style="max-width:58px;" title="项目名{{one_pub.project_name}}"><label ng-if="one_pub.project_short_name">{{one_pub.project_short_name}}</label> <label ng-if="!one_pub.project_short_name">--</label></span>
                        </div>
                        <div  class="version_font_small version_width ver_pe_percent" style="width: 7%">
                            <div class="version-common-icon version-seq-icon" title="需求编号" ></div>
                            <span class="version-icon-span over_hidden" style="max-width: 14px;" title="需求编号{{one_pub.demand_id}}"><label ng-if="one_pub.demand_id">{{one_pub.demand_id}}</label> <label  ng-if="!one_pub.demand_id">--</label></span>
                        </div>
                        <div  class="version_font_small version_width ver_pe_percent">
                            <div class="version-common-icon version-user-icon" title="用户名"></div>
                            <span class="version-icon-span over_hidden" title="用户名{{one_pub.operasion_user_name}}">{{one_pub.operasion_user_name}}</span>
                        </div>
                        <div  class="version_font_small version_width ver_pe_percent" style="width: 217px;">
                            <div class="version-common-icon version-time-icon" title="变更时间"></div>
                            <span class="version-icon-span over_hidden" style="max-width: 172px;" title="{{one_pub.modify_bk_date}} {{one_pub.modify_bk_time}}">变更时间 {{one_pub.modify_bk_date}} {{one_pub.modify_bk_time}}</span>
                        </div>
                        <div  class="version_font_small version_width ver_pe_percent" ng-class="{'ve_no_input':one_pub.version_status==1,'ve_common':one_pub.version_status==2,'ve_back_color':one_pub.version_status==3}" style="width:40px;vertical-align: top;margin-top: 15px;margin-right: 0">
                            <span class="version-icon-span over_hidden" style="margin-top: 0;">{{one_pub.v_status_cn}}</span>
                        </div>
                        <div style="float: right; display: inline-block">
                            <div ng-click="showVersionPop()" class="version_width right-header-btn-group">
                                <div class="version_compare_common version_compare_img"></div>
                            </div>
                            <div class="modify_include_div" custom-scroll custom-config="config.scroll_y_config" ng-if="control.show_version_pop">
                                <span ng-click="comparePubVersion(true,one_ve)" class="modify_span" ng-repeat="one_ve in version.version_list">
                                    <a>{{one_ve.version_view}}</a>
                                </span>
                                <span class="no-compare-version-font" ng-if="version.version_list.length==0">无可比对版本</span>
                            </div>
                            <div class="version_width right-header-btn-group">
                                <div class="version_compare_common version_down_img" ng-click="downloadFile(1)"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--版本文件信息-->
                <div class="row version-file-container">
                    <div class="operate-btn-group">
                        <div class="pub-btn-select"  ng-mouseleave="control.btn_list_show=false">
                            <div class="pub-btn-view" ng-class="control.curr_btn_index==0 ?'pub-btn-compare-act': control.curr_btn_index==1 ? 'pub-btn-pub-act': 'pub-btn-bak-act'" ng-click="showBtnList()">
                                <span class="btn-bg" style="display: inline-block;margin-left: 22px"></span><span>{{control.curr_btn_index==0 ?'比对': control.curr_btn_index==1 ? '发布': '备份'}}</span> <i class="fa fa-sort-desc" style="margin-left:5px;position: relative;top: -2px;"></i>
                            </div>
                            <ul class="btn-select-select" ng-show="control.btn_list_show" ng-mouseleave="control.btn_list_show=false">
                                <li class="pub-btn-item pub-btn-compare" ng-click="control.pre_pub_flag || switchViewToCompare(true,0)" ng-style="{'cursor':control.pre_pub_flag ? 'default' :'pointer'}" ng-class="{'pub-btn-compare-act':control.curr_btn_index==0}" title="{{control.pre_pub_flag ? '预发布版本，不能比对':''}}">
                                   <span class="btn-bg" style="display: inline-block"></span>比对
                                </li>
                                <div class="select-split-line"></div>
                                <li class="pub-btn-item pub-btn-pub" ng-click="switchBackAndpub(false,1)" ng-class="{'pub-btn-pub-act':control.curr_btn_index==1}">
                                    <span class="btn-bg" style="display: inline-block"></span>发布
                                </li>
                                <li class="pub-btn-item pub-btn-bak"  ng-click="control.pre_pub_flag || switchBackAndpub(true,2)" ng-style="{'cursor':control.pre_pub_flag ? 'default' :'pointer'}" ng-class="{'pub-btn-bak-act':control.curr_btn_index==2}" title="{{control.pre_pub_flag ? '预发布版本，暂无备份':''}}">
                                    <span class="btn-bg" style="display: inline-block"></span>备份
                                </li>
                            </ul>
                        </div>
                    </div>
                    <!--预览-->
                    <tabset class="version-tabs" ng-show="!control.view_compare_mode">
                        <tab class="analysis-tab" active="tabs[0]" select="control.view_compare_mode || changeFileMethod(1)">
                            <tab-heading>{{control.curr_btn_index==1 ? '投产包':'备份包'}}</tab-heading>
                            <div class="container-position">
                                <!--左侧-->
                                <div class="left-container">
                                    <div class="left-inner-container">
                                        <div class="filter-input">
                                            <div class="file-filter file-filter-search"></div>
                                            <div class="container-input" ng-if="control.fold_flag"><input type="text" ng-model="package_input.key_word" ng-enter="filterFile()" placeholder="输入关键字"></div>
                                            <div class="container-input" ng-if="!control.fold_flag"><input type="text" ng-model="package_input.key_word" ng-keypress="filterPackage()" placeholder="输入关键字"></div>
                                        </div>
                                        <div class="version-view-mode-position">
                                            <div class="tag-btn-line"></div>
                                            <div class="file-filter file-tag-switch" ng-class="{'tag-file-switch':!control.fold_flag}" ng-click="expandPkgfold()"></div>
                                            <div class="tag-btn-line"></div>
                                            <div class="file-filter" ng-class="pack_file_tree.nodes.length!=0 ? 'down-load-tag' :'down-load-disable'" ng-click="pack_file_tree.nodes.length==0 || downloadFile(4)" title="批量下载"></div><!--投产包-->
                                        </div>
                                    </div>
                                    <!--左侧文件树-->
                                    <div class="left-inner-scroll-container" custom-scroll custom-config="config.scroll_xy_config">
                                        <div ng-if="control.fold_flag">
                                            <div ng-if="!control.search_mode_flag">
                                                <file-tree files="file_nodes" change-path="getRootFile(pack_file_tree,file_nodes,'fold_tree_control')" get-file-content="getFileContent(file_nodes,file_info,'pack_file',1)"></file-tree>
                                            </div>
                                            <div ng-if="control.search_mode_flag">
                                                <div style="text-align: center;margin-top: 10px" ng-if="search_info.loading">
                                                    <i class="fa fa-spinner fa-spin loading-font-color version-font-30"></i>
                                                </div>
                                                <div class="row config-file" ng-repeat="single_file in search_info.search_list" style="margin: 0;">
                                                    <div class="col-sm-7 file-name" style="cursor: pointer;padding-left: 0px" title="{{single_file.file}}" ng-click="getFileContent(file_nodes,file_info,'pack_file',1,single_file)"><span class="fa fa-file-text-o" style="margin-right: 6px"></span><span class="file-text">{{single_file.file}}</span></div>
                                                    <a class="col-sm-5 file-dir" ng-href="" style="cursor: pointer;padding: 0" title="{{single_file.relate_path.substring(0,single_file.relate_path.lastIndexOf('/')+1)}}" ng-click="getDetailFold(single_file.relate_path)">{{single_file.relate_path.substring(0,single_file.relate_path.lastIndexOf('/')+1)}}</a>
                                                </div>
                                                <div class="no-file-font" ng-if="search_info.search_list.length==0 &&!search_info.loading && !control.change_version_loading">
                                                    暂无文件
                                                </div>
                                            </div>
                                        </div>
                                        <div ng-if="!control.fold_flag">
                                            <file-tree files="pack_file_tree" change-path="getPacConfigListFold(pack_file_tree,'pkg')" get-file-content="packageDetail(pack_file_tree,'fold_flag')" ng-if="pack_file_tree.nodes.length!=0 && !control.change_version_loading"></file-tree>
                                            <div class="no-file-font" ng-if="pack_file_tree.nodes.length==0 && !control.change_version_loading">
                                                暂无文件
                                            </div>
                                            <div class="file-tree-loading" ng-if="control.change_version_loading">
                                                <span class="fa fa-spin fa-spinner loading-font-color version-font-30"></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--右侧文件-->
                                <div class="right-container">
                                    <!--文件夹查看-->
                                    <div class="folder" ng-if="file_nodes.curr_file && (file_nodes.curr_file.dir || (file_nodes.curr_file.file_type > 8 && file_nodes.curr_file.file_type < 14))">
                                        <div class="folder-title" style="margin-left: 10px">
                                            <span ng-if="file_nodes.curr_file.file_path==file_nodes.curr_fold_path">版本{{one_pub.version_num}}根目录</span>
                                            <span ng-if="file_nodes.curr_file.file_path!=file_nodes.curr_fold_path && file_nodes.curr_file.dir">文件夹</span>
                                        </div>
                                        <div class="folder-container">
                                            <div class="folder-container-bg" ng-class="{'folder-container-bg-unknow':!file_nodes.curr_file.dir && file_nodes.curr_file.file_type!=9,'folder-container-bg-tar':!file_nodes.curr_file.dir && file_nodes.curr_file.file_type==9}">
                                            </div>
                                            <div class="folder-container-detail">
                                                <div class="folder-name">
                                                    {{file_nodes.curr_file.file}}
                                                </div>
                                                <div class="folder-path">
                                                    <span class="folder-path-label">文件路径：</span>
                                                    <span class="folder-path-font" title="{{file_nodes.curr_file.file_path ? file_nodes.curr_file.file_path==version.file_absolute_path ?  '.../':file_nodes.curr_file.file_path.replace(version.file_absolute_path,'') : '--'}}">
                                                         {{file_nodes.curr_file.file_path ? file_nodes.curr_file.file_path==version.file_absolute_path ?  '.../':file_nodes.curr_file.file_path.replace(version.file_absolute_path,'') : '--'}}
                                                    </span>
                                                    <div style="clear: both"></div>
                                                </div>
                                                <div class="folder-count">
                                                    <span class="folder-count-bg">
                                                        <i></i>&nbsp;&nbsp;<span>文件个数</span>&nbsp;&nbsp;<span>{{file_nodes.curr_file.file_count ? file_nodes.curr_file.file_count:'--'}}</span>
                                                    </span>
                                                    <span class="folder-size"  ng-if="file_nodes.curr_file.size">
                                                        {{file_nodes.curr_file.size}}
                                                    </span>
                                                </div>
                                                <div class="folder-update-time">
                                                    <span class="folder-update-time-bg">
                                                        <i></i>&nbsp;&nbsp;<span>变更时间</span>&nbsp;&nbsp;<span>{{file_nodes.curr_file.modify_time ? file_nodes.curr_file.modify_time :'--'}}</span>
                                                    </span>
                                                </div>
                                                <div class="folder-btn" style="width:100%">
                                                    <div class="folder-compare-btn" ng-if="file_nodes.curr_file.dir" ng-click="showFoldCompareList(1)" ng-mouseleave="control.show_pub_compare_flag=false">
                                                        发布比对
                                                        <div class="modify_include_div" custom-scroll custom-config="config.scroll_y_config" ng-if="control.show_pub_compare_flag" style="left: -20px;">
                                                           <span ng-click="startFoldCompare(true,one_ve,1,$event)" class="modify_span" ng-repeat="one_ve in version.version_list">
                                                                <a>{{one_ve.version_view}}</a>
                                                            </span>
                                                            <span class="no-compare-version-font" ng-if="version.version_list.length==0">无可比对版本</span>
                                                        </div>
                                                    </div>
                                                    <div class="folder-compare-btn"  ng-if="file_nodes.curr_file.dir" ng-click="showFoldCompareList(2)" ng-mouseleave="control.show_full_compare_flag=false">
                                                        全量比对
                                                        <div class="modify_include_div" custom-scroll custom-config="config.scroll_y_config" ng-if="control.show_full_compare_flag"  style="left: -20px;">
                                                           <span ng-click="startFoldCompare(true,one_ve,2,$event)" class="modify_span" ng-repeat="one_ve in version.full_version_list">
                                                                <a>{{one_ve.version_num}}</a>
                                                            </span>
                                                            <span class="no-compare-version-font" ng-if="version.full_version_list.length==0">无可比对版本</span>
                                                        </div>
                                                    </div>
                                                    <div class="folder-down-btn" ng-if="!control.download_loading && control.down_btn" ng-click="downloadFile(5)">
                                                        <i></i>下载
                                                    </div>
                                                    <div class="folder-down-btn" ng-if="!control.download_loading && !control.down_btn" ng-click="pacDownloadFile()">
                                                        <i></i>下载
                                                    </div>
                                                    <div class="folder-download-loading-btn"  ng-if="control.download_loading">
                                                        <span class="fa fa-spinner fa-spin loading-font-color version-font-18"></span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="clear: both;"></div>
                                        </div>
                                    </div>
                                    <!--文件查看-->
                                    <div class="file-detail" ng-if="file_control.pack_file.show_file">
                                        <!--加载信息-->
                                        <div class="file-detail-loading-container" ng-show="file_control.file_loading">
                                            <i class="fa fa-spinner fa-spin loading-font-color version-font-30"></i>
                                        </div>
                                        <div class="container-fluid version-dropdown-menu" ng-if="!file_control.file_loading">
                                            <div class="row file-header-container" ng-if="!file_info.error_msg">
                                                <div class="col-sm-3" style="overflow: hidden;white-space:nowrap;text-overflow: ellipsis;">
                                                    <span class="file-icon" ng-class="formatFileIconStyle()" ng-if="file_control.pack_file.has_file_icon"></span>
                                                    <span class="fa fa-file-text-o file-default-icon" ng-if="!file_control.pack_file.has_file_icon"></span>
                                                    <span class="file-name-right" ng-bind="file_info.file_name ? file_info.file_name : '--'" title="{{file_info.file_name}}"></span>
                                                </div>
                                                <div class="col-sm-4 file-size">
                                                    <span ng-bind="file_info.file_size ? file_info.file_size : ''"></span>
                                                    <span style="padding:0 5px" ng-show="file_info.file_size">|</span>
                                                    <span ng-bind="file_info.file_update_time ? file_info.file_update_time : ''" title="{{file_info.file_update_time}}"></span>
                                                </div>
                                                <div class="col-sm-5 text-right" style="padding-right: 0">
                                                    <span class="code_method" title="切换编码方式" ng-click="file_control.codemethod_loading || control.fold_flag ? changeCodeMethod(1) : changeCodeMethod(4)" ng-if="file_info.file_content">
                                                        {{file_post_header.encoding_type}}
                                                    </span>
                                                    <span class="file-operate" ng-click="!file_info.file_content || fullScreen()" ng-class="file_info.file_content ? 'full-screen':'full-screen-disabled'" title="全屏"></span>
                                                    <span class="file-operate" ng-click="(!file_info.file_content || version.version_list.length == 0) || viewHistory(2)"
                                                          ng-class="(file_info.file_content && version.version_list.length != 0) ? 'history':'history-disabled'" title="{{version.version_list.length === 0 ? '暂无历史版本':'历史查看'}}"></span>
                                                    <span class="file-operate compare" data-toggle="dropdown" title="{{version.version_list.length === 0 ? '暂无可比对版本':'比对'}}" ng-if="version.version_list.length != 0 && file_info.file_content"></span>
                                                    <span class="file-operate compare-disabled" title="{{version.version_list.length === 0 ? '暂无可比对版本':'比对'}}" ng-if="version.version_list.length === 0 || !file_info.file_content"></span>
                                                    <span class="file-operate download" ng-click="control.fold_flag ? downloadFile(6) : downloadFile(7) " title="下载"></span>
                                                    <!--版本弹窗-->
                                                    <div class="dropdown-menu" style="right: 0;left: auto">
                                                        <span ng-click="selectSingleVersion(version.version_num)" class="single-version" ng-repeat="version in version.version_list">
                                                            <a>{{version.version_view}}</a>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row detail-file-container" scroll-control ng-if="!file_info.error_msg && file_info.file_content">
                                                <span class="fa fa-spinner code-loading" ng-show="file_control.codemethod_loading" ng-class="{'fa-spin':file_control.codemethod_loading}"></span>
                                                <textarea
                                                        ui-codemirror="detailFileOptions"
                                                        ui-refresh="file_control.refresh"
                                                        ng-model="file_info.file_content"
                                                        class="form-control">
                                                </textarea>
                                            </div>
                                            <!--错误信息-->
                                            <div class="row" ng-if="file_info.error_msg">
                                                <div class="errormsg_style">{{file_info.error_msg}}</div>
                                            </div>
                                            <!--无文件内容-->
                                            <div class="unview" ng-if="!file_control.pack_file.un_view && !file_info.file_content && !file_info.error_msg">
                                                <span class="fa fa-file-text-o default-icon" ng-show="!file_control.pack_file.is_excel"></span>
                                                <div class="no-preview-file-font">无法浏览文件内容</div>
                                            </div>
                                            <!--无法浏览文件内容-->
                                            <div class="unview" ng-if="file_control.pack_file.un_view && !file_info.error_msg">
                                                <div class="file-icon unview-excel-icon" ng-show="file_control.pack_file.is_excel"></div>
                                                <span class="default-icon" ng-show="!file_control.pack_file.is_excel"></span>
                                                <div class="no-preview-file-font">无法浏览文件内容</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </tab>
                        <tab class="analysis-tab" active="tabs[1]" select="control.view_compare_mode || changeFileMethod(2)">
                            <tab-heading>配置文件</tab-heading>
                            <div class="container-position">
                                <div class="left-container">
                                    <div class="left-inner-container" ng-if="config_files_tree.nodes.length !=0">
                                        <div class="batch-download-icon-position">
                                            <div class="file-filter down-load-tag" ng-click="downloadFile(4)" title="批量下载"></div>
                                        </div>
                                    </div>
                                    <div class="left-inner-scroll-container" custom-scroll custom-config="config.scroll_xy_config">
                                        <div class="config-file" ng-if="config_files_tree.nodes.length!=0">
                                            <file-tree files="config_files_tree" change-path="getPubConfigFileByIp(config_files_tree,'config')" get-file-content="getFileContent(config_files_tree,config_file_info,'config_file',2)" alter="true"></file-tree>
                                        </div>
                                        <div class="no-file-font" ng-if="config_files_tree.nodes.length==0">
                                            暂无文件
                                        </div>
                                    </div>
                                </div>
                                <div class="right-container">
                                    <!--配置文件-文件夹查看-->
                                    <div class="folder" ng-if="config_files_tree.curr_file && (config_files_tree.curr_file.dir || (config_files_tree.curr_file.file_type > 8 && config_files_tree.curr_file.file_type < 14))">
                                        <div class="folder-title">
                                            <span ng-if="config_files_tree.curr_file.file_path==config_files_tree.curr_fold_path">版本{{one_pub.version_num}}根目录</span>
                                            <span ng-if="config_files_tree.curr_file.file_path!=config_files_tree.curr_fold_path && config_files_tree.curr_file.dir">文件夹</span>
                                        </div>
                                        <div class="folder-container">
                                            <div class="folder-container-bg" ng-class="{'folder-container-bg-unknow':!config_files_tree.curr_file.dir && config_files_tree.curr_file.file_type!=9,'folder-container-bg-tar':!config_files_tree.curr_file.dir && config_files_tree.curr_file.file_type==9}">
                                            </div>
                                            <div class="folder-container-detail">
                                                <div class="folder-name">
                                                    {{config_files_tree.curr_file.file}}
                                                </div>
                                                <div class="folder-path">
                                                    <span class="folder-path-label">文件路径：</span>
                                                    <span class="folder-path-font" title="{{config_files_tree.curr_file.file_path}}">
                                                        {{config_files_tree.curr_file.file_path}}
                                                    </span>
                                                    <div style="clear: both;"></div>
                                                </div>
                                                <div class="folder-count">
                                                    <span class="folder-count-bg">
                                                        <i></i>&nbsp;&nbsp;<span>文件个数</span>&nbsp;&nbsp;<span>{{config_files_tree.curr_file.file_count ? config_files_tree.curr_file.file_count:'--'}}</span>
                                                    </span>
                                                    <span class="folder-size" ng-if="config_files_tree.curr_file.size">
                                                        {{config_files_tree.curr_file.size}}
                                                    </span>
                                                </div>
                                                <div class="folder-update-time">
                                                    <span class="folder-update-time-bg">
                                                        <i></i>&nbsp;&nbsp;<span>变更时间</span>&nbsp;&nbsp;<span>{{config_files_tree.curr_file.modify_time ? config_files_tree.curr_file.modify_time :'--'}}</span>
                                                    </span>
                                                </div>
                                                <div class="folder-btn">
                                                    <div class="folder-down-btn" ng-if="!control.download_loading" ng-click="downloadFile(2)">
                                                        <i></i>
                                                        下载
                                                    </div>
                                                    <div class="folder-download-loading-btn" ng-if="control.download_loading">
                                                        <span class="fa fa-spinner fa-spin loading-font-color version-font-18"></span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="clear: both;"></div>
                                        </div>
                                    </div>
                                    <!--文件查看-->
                                    <div class="file-detail" ng-if="file_control.config_file.show_file">
                                        <!--加载信息-->
                                        <div class="file-detail-loading-container"  ng-show="file_control.file_loading">
                                            <i class="fa fa-spinner fa-spin loading-font-color version-font-30"></i>
                                        </div>
                                        <div class="container-fluid version-dropdown-menu" ng-if="!file_control.file_loading">
                                            <div class="row file-header-container" ng-if="!file_info.error_msg">
                                                <div class="col-sm-3" style="overflow: hidden;white-space:nowrap;text-overflow: ellipsis;">
                                                    <span class="file-icon" ng-class="formatFileIconStyle()" ng-if="file_control.config_file.has_file_icon"></span>
                                                    <span class="fa fa-file-text-o file-default-icon" ng-if="!file_control.config_file.has_file_icon"></span>
                                                    <span class="file-name-right" ng-bind="config_file_info.file_name ? config_file_info.file_name : '--'" title="{{config_file_info.file_name}}"></span>
                                                </div>
                                                <div class="col-sm-4 file-size">
                                                    <span ng-bind="config_file_info.file_size ? config_file_info.file_size : ''"></span>
                                                    <span style="padding:0 5px" ng-show="config_file_info.file_size">|</span>
                                                    <span ng-bind="config_file_info.file_update_time ? config_file_info.file_update_time : ''" title="{{config_file_info.file_update_time}}"></span>
                                                </div>
                                                <div class="col-sm-5 text-right" style="padding-right: 0">
                                                    <span class="code_method" title="切换编码方式" ng-click="file_control.codemethod_loading || changeCodeMethod(2)" ng-if="config_file_info.file_content">
                                                        {{file_post_header.encoding_type}}
                                                    </span>
                                                    <span class="file-operate" ng-click="!config_file_info.file_content || fullScreen()" ng-class="config_file_info.file_content ? 'full-screen':'full-screen-disabled'" title="全屏"></span>
                                                    <span class="file-operate" ng-click="(!config_file_info.file_content || version.version_list.length == 0) || viewHistory(1)"
                                                          ng-class="(config_file_info.file_content && version.version_list.length != 0) ? 'history':'history-disabled'" title="{{version.version_list.length === 0 ? '暂无历史版本':'历史查看'}}"></span>
                                                    <span class="file-operate compare" data-toggle="dropdown" title="{{version.version_list.length === 0 ? '暂无可比对版本':'比对'}}" ng-if="version.version_list.length != 0 && config_file_info.file_content"></span>
                                                    <span class="file-operate compare-disabled" title="{{version.version_list.length === 0 ? '暂无可比对版本':'比对'}}" ng-if="version.version_list.length === 0 || !config_file_info.file_content"></span>
                                                    <span class="file-operate download" ng-click="downloadFile(3)" title="下载"></span>
                                                    <!--版本弹窗-->
                                                    <div class="dropdown-menu" style="right: 0;left: auto">
                                                        <span ng-click="selectSingleVersion(version.version_num)" class="single-version" ng-repeat="version in version.version_list">
                                                            <a>{{version.version_view}}</a>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row detail-file-container" scroll-control ng-if="!file_info.error_msg && config_file_info.file_content" >
                                                <span class="fa fa-spinner code-loading" ng-show="file_control.codemethod_loading" ng-class="{'fa-spin':file_control.codemethod_loading}"></span>
                                                <textarea
                                                        ui-codemirror="detailFileOptions"
                                                        ui-refresh="file_control.refresh"
                                                        ng-model="config_file_info.file_content"
                                                        class="form-control">
                                                </textarea>
                                            </div>
                                            <!--错误信息-->
                                            <div class="row" ng-if="config_file_info.error_msg">
                                                <div class="errormsg_style">{{config_file_info.error_msg}}</div>
                                            </div>
                                            <!--无文件内容-->
                                            <div class="unview" ng-if="!file_control.config_file.un_view && !config_file_info.file_content && !config_file_info.error_msg">
                                                <span class="fa fa-file-text-o default-icon" ng-show="!file_control.config_file.is_excel"></span>
                                                <div class="no-preview-file-font">无法浏览文件内容</div>
                                            </div>
                                            <!--无法浏览文件内容-->
                                            <div class="unview" ng-if="file_control.config_file.un_view && !config_file_info.error_msg">
                                                <div class="file-icon unview-excel-icon" ng-show="file_control.config_file.is_excel"></div>
                                                <span class="default-icon" ng-show="!file_control.config_file.is_excel"></span>
                                                <div class="no-preview-file-font">无法浏览文件内容</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </tab>
                        <tab class="analysis-tab" active="tabs[2]" heading="清单" select="control.view_compare_mode || changeFileMethod(3)" >
                            <div class="container-position">
                                <div class="left-container">
                                    <div class="left-inner-container" ng-if="manifest_files_tree.nodes.length!=0">
                                        <div class="batch-download-icon-position">
                                            <div class="file-filter down-load-tag" ng-click="downloadFile(4)" title="批量下载" ng-show="manifest_files_tree.nodes.length !=0"></div>
                                        </div>
                                    </div>
                                    <div class="left-inner-scroll-container" custom-scroll custom-config="config.scroll_xy_config">
                                        <file-tree files="manifest_files_tree" change-path="getPacConfigListFold(manifest_files_tree,'list')" get-file-content="getFileContent(manifest_files_tree,manifest_file_info,'manifest_file',3)" ng-if="manifest_files_tree.nodes.length!=0"></file-tree>
                                        <div class="no-file-font" ng-if="manifest_files_tree.nodes.length==0">
                                            暂无文件
                                        </div>
                                    </div>
                                </div>
                                <div class="right-container">
                                    <!--清单文件-文件夹查看-->
                                    <div class="folder" ng-if="manifest_files_tree.curr_file && manifest_files_tree.curr_file.dir">
                                        <div class="folder-title">
                                            <span ng-if="manifest_files_tree.curr_file.file_path==manifest_files_tree.curr_fold_path">版本{{one_pub.version_num}}根目录</span>
                                            <span ng-if="manifest_files_tree.curr_file.file_path!=manifest_files_tree.curr_fold_path && manifest_files_tree.curr_file.dir">文件夹</span>
                                        </div>
                                        <div class="folder-container">
                                            <div class="folder-container-bg" ng-class="{'folder-container-bg-unknow':!manifest_files_tree.curr_file.dir && manifest_files_tree.curr_file.file_type!=9,'folder-container-bg-tar':!manifest_files_tree.curr_file.dir && manifest_files_tree.curr_file.file_type==9}">
                                            </div>
                                            <div class="folder-container-detail">
                                                <div class="folder-name" style="overflow: hidden;text-overflow: ellipsis;white-space: nowrap">
                                                    {{manifest_files_tree.curr_file.file}}
                                                </div>
                                                <div class="folder-path">
                                                    <span class="folder-path-label">文件路径：</span>
                                                    <span class="folder-path-font" title="{{manifest_files_tree.curr_file.file_path}}">
                                                        {{manifest_files_tree.curr_file.file_path}}
                                                    </span>
                                                    <div style="clear: both;"></div>
                                                </div>
                                                <div class="folder-count">
                                                    <span class="folder-count-bg">
                                                        <i></i>&nbsp;&nbsp;<span>文件个数</span>&nbsp;&nbsp;<span>{{manifest_files_tree.curr_file.file_count ? manifest_files_tree.curr_file.file_count:'--'}}</span>
                                                    </span>
                                                    <span class="folder-size" ng-if="manifest_files_tree.curr_file.size">
                                                        {{manifest_files_tree.curr_file.size}}
                                                    </span>
                                                </div>
                                                <div class="folder-update-time">
                                                    <span class="folder-update-time-bg">
                                                        <i></i>&nbsp;&nbsp;<span>变更时间</span>&nbsp;&nbsp;<span>{{manifest_files_tree.curr_file.modify_time ? manifest_files_tree.curr_file.modify_time :'--'}}</span>
                                                    </span>
                                                </div>
                                                <div class="folder-btn">
                                                    <div class="folder-down-btn" ng-click="downloadFile(2)">
                                                        <i></i>下载
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="clear: both;"></div>
                                        </div>
                                    </div>
                                    <!--清单文件查看-->
                                    <div class="file-detail" ng-if="file_control.manifest_file.show_file">
                                        <!--加载信息-->
                                        <div class="file-detail-loading-container" ng-show="file_control.file_loading">
                                            <i class="fa fa-spinner fa-spin loading-font-color version-font-30"></i>
                                        </div>
                                        <div class="container-fluid" ng-if="!file_control.file_loading">
                                            <div class="row file-header-container" ng-if="!manifest_file_info.error_msg">
                                                <div class="col-sm-3" style="overflow: hidden;white-space:nowrap;text-overflow: ellipsis;">
                                                    <span class="file-icon" ng-class="formatFileIconStyle()" ng-if="file_control.manifest_file.has_file_icon"></span>
                                                    <span class="fa fa-file-text-o file-default-icon" ng-if="!file_control.manifest_file.has_file_icon"></span>
                                                    <span class="file-name-right" ng-bind="manifest_file_info.file_name ? manifest_file_info.file_name : '--'" title="{{manifest_file_info.file_name}}"></span>
                                                </div>
                                                <div class="col-sm-4 file-size">
                                                    <span ng-bind="manifest_file_info.file_size ? manifest_file_info.file_size : ''"></span>
                                                    <span style="padding:0 5px" ng-show="manifest_file_info.file_size">|</span>
                                                    <span ng-bind="manifest_file_info.file_update_time ? manifest_file_info.file_update_time : ''" title="{{manifest_file_info.file_update_time}}"></span>
                                                </div>
                                                <div class="col-sm-5 text-right" style="padding-right: 0">
                                                    <span class="code_method" title="切换编码方式" ng-click="file_control.codemethod_loading || changeCodeMethod()" ng-if="manifest_file_info.file_content && !file_control.manifest_file.is_excel">
                                                        {{file_post_header.encoding_type}}
                                                    </span>
                                                    <span class="file-operate" ng-click="!manifest_file_info.file_content || fullScreen()" ng-class="manifest_file_info.file_content ? 'full-screen':'full-screen-disabled'" title="全屏" ng-if="!file_control.manifest_file.is_excel"></span>
                                                    <span class="file-operate" ng-click="(!manifest_file_info.file_content || version.version_list.length ==0) || viewHistory(1)" ng-class="(manifest_file_info.file_content && version.version_list.length != 0) ? 'history':'history-disabled'"
                                                          title="{{version.version_list.length === 0 ? '暂无历史版本':'历史查看'}}"  ng-if="!file_control.manifest_file.is_excel"></span>
                                                    <span class="file-operate download" ng-click="downloadFile(3)" title="下载"></span>
                                                </div>
                                            </div>
                                            <div class="row detail-file-container" scroll-control ng-if="!manifest_file_info.error_msg && manifest_file_info.file_content">
                                                <span class="fa fa-spinner code-loading" ng-show="file_control.codemethod_loading" ng-class="{'fa-spin':file_control.codemethod_loading}"></span>
                                                <textarea
                                                        ui-codemirror="detailFileOptions"
                                                        ui-refresh="file_control.refresh"
                                                        ng-model="manifest_file_info.file_content"
                                                        class="form-control">
                                                </textarea>
                                            </div>
                                            <!--错误信息-->
                                            <div class="row" ng-if="manifest_file_info.error_msg">
                                                <div class="errormsg_style">{{manifest_file_info.error_msg}}</div>
                                            </div>
                                            <!--无文件内容-->
                                            <div class="unview" ng-if="!file_control.manifest_file.un_view && !manifest_file_info.file_content && !manifest_file_info.error_msg">
                                                <span class="fa fa-file-text-o default-icon" ng-show="!file_control.manifest_file.is_excel"></span>
                                                <div class="no-preview-file-font">无法浏览文件内容</div>
                                            </div>
                                            <!--无法浏览文件内容-->
                                            <div class="unview" ng-if="file_control.manifest_file.un_view && !manifest_file_info.error_msg">
                                                <div class="file-icon unview-excel-icon" ng-show="file_control.manifest_file.is_excel"></div>
                                                <span class="default-icon" ng-show="!file_control.manifest_file.is_excel"></span>
                                                <div class="no-preview-file-font">无法浏览文件内容</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </tab>
                    </tabset>
                    <!--比对-->
                    <tabset class="version-tabs compare-mode"  ng-if="control.view_compare_mode">
                        <tab class="analysis-tab " active="tabs[0]" select="changeFileMethod(1,true)">
                            <tab-heading>投产包</tab-heading>
                            <div class="row compare-mode-header">
                                <div class="col-sm-6"></div>
                                <div class="col-sm-4">
                                    <bs-select width=200
                                               no-border
                                               items="compare_view_info.bak_pac_ip_list"
                                               my-select="compare_view_info.bak_ip"
                                               disable="pub_bak_nodes.loading"
                                               select-val="selectBakPacIp(selectKey)"
                                    </bs-select>
                                </div>
                            </div>
                            <div class="row compare-container">
                                <div class="col-sm-6 left-block">
                                    <div class="row compare-mode-inner-header">
                                        <span class="compare-mode-label">发布版：</span>
                                        <div class="batch-download-icon-position">
                                            <div class="file-filter down-load-tag" ng-click="batchDownloadFile(1)" title="下载发布投产包"></div>
                                        </div>
                                    </div>
                                    <div class="compare-scroll-container" id="left_scroll_container_1" custom-scroll custom-config="config.scroll_xy_config"  callbacks="compare_left_scroll" ng-mouseover="leftScrollBarMouseover()" ng-if="control.pub_fold_flag">
                                        <div class="file-tree-cover" ng-style="{'z-index':config.pkg_loading_config.disabled_control ? '3':'0'}"></div>
                                        <file-tree files="pub_bak_nodes" change-path="pubBakTreeCompare()" go="goCompare()" db-file="dbClickCompareFile()" compare-config="config.compare_left_config" common-control="config.pkg_loading_config"></file-tree>
                                    </div>
                                    <div class="no-file-font" ng-if="compare_view_info.bak_pac_ip_list.length==0 || compare_view_info.package_list.length==0">
                                        暂无文件
                                    </div>
                                </div>
                                <div class="col-sm-6 right-block">
                                    <div class="row compare-mode-inner-header">
                                        <span class="compare-mode-label">备份版：</span>
                                        <div class="batch-download-icon-position">
                                            <div class="file-filter down-load-tag" ng-click="batchDownloadFile(2)" title="下载备份投产包"></div>
                                        </div>
                                    </div>
                                    <div class="compare-scroll-container" id="right_scroll_container_1" custom-scroll custom-config="config.scroll_xy_config"  callbacks="compare_right_scroll" ng-mouseover="rightScrollBarMouseover()" ng-if="control.pub_fold_flag">
                                        <div class="file-tree-cover" ng-style="{'z-index':config.pkg_loading_config.disabled_control ? '3':'0'}"></div>
                                        <file-tree files="pub_bak_nodes" change-path="pubBakTreeCompare()" go="goCompare()" db-file="dbClickCompareFile()" compare-config="config.compare_right_config" common-control="config.pkg_loading_config" ng-if="pub_bak_nodes.nodes.length!=0 && !pub_bak_nodes.loading"></file-tree>
                                        <div ng-if="pub_bak_nodes.loading" class="compare-tree-loading">
                                            <i class="fa fa-spinner fa-spin loading-font-color version-font-30"></i>
                                        </div>
                                        <div class="no-file-font" ng-if="pub_bak_nodes.nodes.length==0 && !pub_bak_nodes.loading" style="margin-top: 30px">
                                            暂无文件
                                        </div>
                                    </div>
                                    <div class="no-file-font" ng-if="(compare_view_info.bak_pac_ip_list.length==0 || compare_view_info.package_list.length==0) && !control.pub_fold_flag" style="padding-right: 15px;margin-top:30px">
                                        暂无文件
                                    </div>
                                </div>
                            </div>
                        </tab>
                        <tab class="analysis-tab" active="tabs[1]" select="changeFileMethod(2,true)">
                            <tab-heading>配置文件</tab-heading>
                            <div class="row compare-mode-header">
                                <div class="col-sm-6">
                                    <div class="row">
                                        <div class="col-sm-10">
                                            <bs-select width=100
                                                       no-border
                                                       disable="pub_bak_list_compare.loading"
                                                       items="ip_data.pub_config_ip_list"
                                                       my-select="ip_data.pub_config_ip"
                                                       select-val="selectConfigOrListIp(selectKey,1)">
                                            </bs-select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6"></div>
                            </div>
                            <div class="row compare-container">
                                <div class="col-sm-6 left-block">
                                    <div class="row compare-mode-inner-header">
                                        <span class="compare-mode-label">发布版：</span>
                                        <div class="batch-download-icon-position">
                                            <div class="file-filter down-load-tag" ng-click="batchDownloadFile(1)" title="下载发布配置文件" ng-show="pub_bak_list_compare.compare_path1 || pub_bak_list_compare.compare_path2"></div>
                                        </div>
                                    </div>
                                    <div class="compare-scroll-container" id="left_scroll_container_2" custom-scroll custom-config="config.scroll_xy_config"  callbacks="compare_left_scroll" ng-mouseover="leftScrollBarMouseover()" ng-if="control.config_control">
                                        <div class="file-tree-cover" ng-style="{'z-index':config.configfile_loading_config.disabled_control ? '3':'0'}"></div>
                                        <file-tree files="pub_bak_list_compare" change-path="pubListTreeCompare()" go="goCompareList()" db-file="dbClickCompareFile()" compare-config="config.compare_left_config" common-control="config.configfile_loading_config"></file-tree>
                                    </div>
                                    <div class="no-file-font" ng-if="ip_data.pub_config_ip_list.length==0">
                                        暂无文件
                                    </div>
                                </div>
                                <div class="col-sm-6 right-block">
                                    <div class="row compare-mode-inner-header">
                                        <span class="compare-mode-label">备份版：</span>
                                        <div class="batch-download-icon-position">
                                            <div class="file-filter down-load-tag" ng-click="batchDownloadFile(2)" title="下载备份配置文件" ng-show="pub_bak_list_compare.compare_path1 || pub_bak_list_compare.compare_path2"></div>
                                        </div>
                                    </div>
                                    <div class="compare-scroll-container" id="right_scroll_container_2" custom-scroll custom-config="config.scroll_xy_config"  callbacks="compare_right_scroll" ng-mouseover="rightScrollBarMouseover()"  ng-if="control.config_control">
                                        <div class="file-tree-cover" ng-style="{'z-index':config.configfile_loading_config.disabled_control ? '3':'0'}"></div>
                                        <file-tree files="pub_bak_list_compare" change-path="pubListTreeCompare()" go="goCompareList()" db-file="dbClickCompareFile()" compare-config="config.compare_right_config" common-control="config.configfile_loading_config" ng-if="pub_bak_list_compare.nodes.length!=0"></file-tree>
                                        <div ng-if="pub_bak_list_compare.loading" class="compare-tree-loading">
                                            <i class="fa fa-spinner fa-spin loading-font-color version-font-30"></i>
                                        </div>
                                        <div class="no-file-font" ng-if="pub_bak_list_compare.nodes.length==0 && !pub_bak_list_compare.loading" style="margin-top: 30px">
                                            暂无文件
                                        </div>
                                    </div>
                                    <div class="no-file-font" ng-if="ip_data.pub_config_ip_list.length==0">
                                        暂无文件
                                    </div>
                                </div>
                            </div>
                        </tab>
                        <tab class="analysis-tab" active="tabs[2]" heading="清单" select="changeFileMethod(3,true)">
                            <div class="row compare-mode-header">
                                <div class="col-sm-offset-6 col-sm-6">
                                    <div class="row">
                                        <div class="col-sm-10">
                                            <bs-select width=100
                                                       no-border
                                                       disable="false"
                                                       items="ip_data.manifet_ip_list"
                                                       my-select="ip_data.back_manifet_ip"
                                                       select-val="selectConfigOrListIp(selectKey,2)">
                                            </bs-select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row compare-container">
                                <div class="col-sm-6 left-block">
                                    <div class="row compare-mode-inner-header">
                                        <span class="compare-mode-label">发布版：</span>
                                        <div class="batch-download-icon-position">
                                            <div class="file-filter down-load-tag" ng-click="batchDownloadFile(1)" ng-show="pub_manifest_tree.nodes.length" title="批量下载发布清单"></div>
                                        </div>
                                    </div>
                                    <div class="compare-scroll-container" custom-scroll custom-config="config.scroll_xy_config" callbacks="compare_left_scroll">
                                        <file-tree files="pub_manifest_tree" change-path="getPacConfigListFold(pub_manifest_tree,'list')" get-file-content="chooseComparePath(pub_manifest_tree,1)" ng-if="pub_manifest_tree.nodes.length!=0"></file-tree>
                                        <div class="no-file-font" ng-if="pub_manifest_tree.nodes.length==0">
                                            暂无文件
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6 right-block">
                                    <div class="row compare-mode-inner-header">
                                        <span class="compare-mode-label">备份版：</span>
                                        <div class="batch-download-icon-position">
                                            <div class="file-filter down-load-tag" ng-click="batchDownloadFile(2)" ng-show="bak_manifest_tree.nodes.length" title="批量下载备份清单"></div>
                                        </div>
                                    </div>
                                    <div class="compare-scroll-container" custom-scroll custom-config="config.scroll_xy_config" callbacks="compare_right_scroll">
                                        <div ng-if="control.list_control && bak_manifest_tree.curr_fold_path">
                                            <file-tree files="bak_manifest_tree" change-path="getPacConfigListFold(bak_manifest_tree,'list')"></file-tree>
                                        </div>
                                        <div class="no-file-font" ng-if="!bak_manifest_tree.curr_fold_path">
                                            暂无文件
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </tab>
                    </tabset>
                </div>
            </div>
        </div>
    </div>
    <div class="row" ng-if="control.loading " style="margin-top: 238px;">
        <div class="col-sm-4 col-sm-offset-4 text-center">
            <div>
                <span class="fa fa-spinner fa-spin loading-font-color version-font-30"></span>
            </div>
            <div class="version-margin-top-10">
                <span class="loading-font-color">正在获取信息&nbsp;&nbsp;</span>
            </div>
        </div>
    </div>
</div>

<!--文件历史查看-->
<div ng-if="file_control.show_file_history" ng-include="'views/publish/version/file_history_detail.html'"></div>
<!--文件对比查看-->
<div ng-if="file_control.show_file_compare" ng-include="'views/publish/version/file_compare.html'"></div>
<!--目录对比查看-->
<div ng-if="control.show_fold_compare" ng-include="'views/publish/version/fold_compare.html'" ng-controller="foldController"></div>