<style>
    .proj_loading_data{
        margin:0 auto;font-size: 20px;color:#CCC;border:1px dashed #CCC;
        height:auto;line-height:50px;width:320px;border-radius: 4px;
        text-align: center;margin-bottom: 15px
    }
    /*历史回退信息样式*/
    .rollback_tag{
        position: relative;
        background: #191e26;
        color: #808080;
        padding: 0px 10px;
        margin-left: 1px;
        width: 80px;
        height: 25px;
        line-height: 25px;
        display: inline-block;
    }
    .rollback_tag:before{
        position: absolute;
        content: " ";
        border: transparent 14px solid;
        border-right-color: #191e26;
        top: -1px;
        left: -26px;
        height: 0;
        width: 0;
    }
    .rollback_tag:after{
        position: absolute;
        content: " ";
        background: #3E53B8;
        width: 8px;
        height: 8px;
        top: 8px;
        left: -3px;
        border-radius: 4px;
    }
    .temp-circle{
        width:10px;
        height:10px;background: #CCCCCC;border-radius: 50%;
    }
    .temp-line{
        height: 100%;width: 1px;background: #ccc;margin-left: 4px;
    }
    .tag_position{
        position: absolute;top:20px;
        right: -500px;
        transition: right 1s;
        z-index: 999;
    }
    .tag_position:hover{
        right : 0px;
    }
    #commandShell .CodeMirror {
        height: 43px;
    }
    #commandShell2 .CodeMirror{
        height: 43px;
    }


    ::-ms-clear,::-ms-reveal{display:none;}



</style>
<div class="modal-header">
    <h3 class="modal-title">回退准备</h3>
    <div ng-click="cancel()"></div>
</div>
<div class="modal-body plan_preProd" style="min-height: 500px;max-height: 600px;overflow: hidden;">
    <form name="form.saveRollInfoForm"  class="form-horizontal" novalidate autocomplete="off" onKeyPress="if(event.keyCode==13) return false">
        <!--系统节点-->
        <div class="row form-style">
            <label class="col-sm-2 label-key">系统节点</label>
            <div class="col-sm-8 label-value">
                <div ng-if="!rollback_info.prog_cn_name || !control.get_prog_complete"><span style="color: #ccc;">请先选择方案获取节点信息</span></div>
                <div ng-if="rollback_info.prog_cn_name">
                    <div ng-if="control.get_node_list_loading && control.get_prog_complete" style="color:#44dcfd;">正在获取节点&nbsp;&nbsp;<i  class="fa fa-spinner fa-spin" style="color:#4cae4c;"></i></div>
                    <div ng-if="!control.get_node_list_loading && control.get_prog_complete">
                        <div ng-if="data.node_list.length != 0">
                            <li ng-repeat="node in data.node_list" style="list-style: none; display: inline-block;margin-right: 25px">
                                <input type="checkbox" i-check ng-model="node.is_checked" />
                                <span style="margin-left: 10px">{{node.soc_ip}}</span>
                            </li>
                        </div>
                        <div ng-if="data.node_list.length == 0">
                            <span style="color: #999;">无节点</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--选择回退方案-->
        <div class="row form-style" style="margin-top: 10px">
            <label class="col-sm-2 label-key" style="padding-top: 5px;">回退方案</label>
            <div class="col-sm-8 label-value">
                <bs-select width=200 name="prog_name"
                           items="data.rollBack_program_list"
                           my-select="rollback_info.prog_cn_name"
                           select-val="selectProgram(selectKey)"
                           option-labal="prog_cn_name"
                           option-key="prog_id"
                           loading="control.get_prog_list_loading"
                           required></bs-select>
                <validate-msg tag-cn-name="回退方案" type="select" name="prog_name" model="rollback_info.prog_id"></validate-msg>
            </div>
        </div>
        <!--回退方案信息-->
        <div  custom-scroll custom-config="config.rollback_scroll" style="max-height: 450px;min-height: 420px;">
            <!-- 文件获取方式-->
            <div class="row form-style" ng-if="rollback_info.propackage_list.length != 0" style="margin-top: 10px;">
                <label class="col-sm-2 control-label label-key">回退包</label>
                <div class="col-sm-8">
                    <div class="form-group checkbox label-value">
                        <div style="display: inline-block;">
                            <input type="radio" name="upload_flag" i-check ng-model="rollback_info.upload_flag" ng-change="changeFileFlag(2);" value="2" ng-disabled="!rollback_info.version_soc_name">
                            <span style="position: relative; top: 1px;">从版本机</span>

                        </div>
                        <div style="margin-left: 40px;display: inline-block;">
                            <input type="radio" name="upload_flag" i-check ng-model="rollback_info.upload_flag" ng-change="changeFileFlag(1);" value="1"  style="margin-left: 50px;">
                            <span style="position: relative; top: 1px;">从本地</span>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 包-->
            <div class="row form-style" ng-if="rollback_info.propackage_list.length != 0">
                <div class="col-sm-8 col-sm-offset-2" ng-if="rollback_info.propackage_list.length != 0">
                    <!--发布包-->
                    <fieldset class="left" style="margin-right: 0px;min-width: 340px">
                        <legend style="color: #29B0E9">回退包</legend>
                        <div ng-if="rollback_info.propackage_list.length != 0">
                            <div class="row pac-row form-style" ng-repeat="prodpac in rollback_info.propackage_list"
                                 id="prod-pac-{{$index}}" ng-mouseenter="addPacBg(prodpac,$index)" ng-mouseleave="removePacBg(prodpac,$index)">
                                <label class="col-sm-2 control-label label-key" style="padding-left: 4px;padding-right: 10px"><span  ng-if="prodpac.required_flag"  style="margin-right: 5px;color: #e9416e;">*</span>{{prodpac.type_cn_name}}</label>
                                <div class="col-sm-10">
                                    <div ng-repeat="propackage in prodpac.package_name_list" class="addPackageBorder">
                                        <div class="proj_packageTarFile_image"></div>
                                        <div class="proj_packPath">
                                            <a  class="plan_preFullPath">{{propackage.propackage_full_path.substring(propackage.propackage_full_path.lastIndexOf('/')+1, propackage.propackage_full_path.length)}}</a>
                                        </div>
                                        <div style="margin-left: 32px;margin-top: -6px;">
                                            <a ng-if="!propackage.downLoading && !propackage.no_exsit && !propackage.is_exsit_loading" class="ac-upload" ng-click="downloadPackage(propackage)" style="margin-right: 12px;">下载</a>
                                            <span ng-if="!control.ready_info_flag && !propackage.downLoading && !propackage.no_exsit && !propackage.is_exsit_loading" class="plan_preDown_seperateLine">|</span>
                                            <a ng-if="!control.ready_info_flag && !propackage.downLoading && !propackage.no_exsit && !propackage.is_exsit_loading"
                                               ng-click="removeProdPackage(rollback_info.propackage_list,prodpac,propackage)" class="ac-upload">删除</a>
                                            <span ng-if="propackage.is_exsit_loading" class="plan_preDown_loading">文件下载中<i  class="fa fa-spinner fa-spin"></i></span>
                                            <span ng-if="propackage.no_exsit" class="plan_preNoneFile">
                                                <span class="plan_preNoneFile_span">获取失败</span>
                                                <a ng-click="removeProdPackage(rollback_info.propackage_list,prodpac,propackage)" class="ac-upload plan_preNoneFileDelete_a">删除</a>
                                            </span>
                                        </div>
                                    </div>
                                    <div title="{{'添加'+ prodpac.type_cn_name}}" ng-if="!prodpac.add_pac_btn_disable"
                                         ng-click="addProdPackage($index,1)" class="plusHover">
                                        <span  class="fa fa-plus plan_preAddPackage_span"></span>
                                    </div>
                                    <div ng-if="prodpac.add_pac_btn_disable" class="plus-disable">
                                        <span  class="fa fa-plus plan_preAddPackage_span"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </fieldset>
                    <div class="form-group" ng-if="control.package_exsit_flag" style="margin: 10px 0 -5px 0;float: left;">
                        <li class="plan_pre_uploadpack">请上传回退包</li>
                    </div>
                </div>
            </div>
            <!--回退方案信息-->
            <div class="row">
                <div class="col-sm-offset-2 col-sm-9" style="margin-top: 10px;">
                    <div class="proj_loading_data" ng-if="control.valid_prog_loading">
                        <span style="color:#44dcfd;">方案完整性校验&nbsp;&nbsp;<i  class="fa fa-spinner fa-spin" style="color:#4cae4c;"></i></span>
                    </div>
                    <div ng-if="valid_prog_error_msg && !control.valid_prog_loading">
                        <div class="proj_errorMsg">
                            <span style="color:#d9534f;">方案完整性验证失败</span>
                            <div  style=" color: #666;font-size: 12px;height: auto;word-break: break-all;"  ng-bind="valid_prog_error_msg"></div>
                        </div>
                    </div>
                    <div ng-if="control.valid_prog_complete">
                        <!-- 方案信息加载中-->
                        <div ng-if="control.get_prog_loading">
                            <div class="proj_loading_data">
                                <span style="color:#44dcfd;">正在获取方案信息&nbsp;&nbsp;<i  class="fa fa-spinner fa-spin" style="color:#4cae4c;"></i></span>
                            </div>
                        </div>
                        <!-- 方案信息加载出错-->
                        <div ng-if="!control.get_prog_loading && errorMessage">
                            <div class="proj_errorMsg">
                                <span style="color:#d9534f;">获取方案信息异常</span>
                                <div class="proj_valid_msgError" ng-bind="errorMessage"></div>
                            </div>
                        </div>
                        <!--方案加载成功-->
                        <div ng-if="!control.get_prog_loading">
                            <!--阶段信息-->
                            <div class="row" ng-if="rollback_info.group_list.length !=0">
                                <div class="col-sm-12">
                                    <div class="phase-container"  ng-repeat="group in rollback_info.group_list">
                                        <div class="phase-module">
                                            <!--分组头样式-->
                                            <div class="phase-container-header">
                                                <div class="col-sm-1 group-phase-icon"></div>
                                                <div class="col-sm-4" style="padding-left: 10px;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;">
                                                    <span ng-bind="group.group_name" title="{{group.group_name}}"></span>
                                                </div>
                                                <div class="col-sm-2" style="padding-right: 5px;float: right;">
                                                    <div class="togglebutton">
                                                        <label style="font-size: 12px;">
                                                            <input type="checkbox" ng-model="group.expand_flag" ng-if="group.nav_show_flag == 0 || group.nav_show_flag == 1 " ng-click="expandCollapseAll(group)">
                                                            <input type="checkbox" ng-model="group.expand_flag" ng-if="group.nav_show_flag == 2" ng-click="colseCollapseAll(group)">
                                                            <span class="toggle" style="vertical-align: middle;margin-right: -2px;"></span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                            <!--条件分组发布包-->
                                            <div class="condition-group-pac" ng-if="group.group_type==3">
                                                <label class="checkbox-inline" ng-repeat="pac in group.temp_pac_type_list">
                                                    <input type="checkbox" i-check name="pac_group" disabled  ng-model="pac.state">&nbsp;&nbsp;&nbsp;&nbsp;{{pac.type_name}}
                                                </label>
                                            </div>
                                            <!--分组阶段样式-->
                                            <div class="row" style="margin-top: 5px;padding-left: 10px">
                                                <div class="col-sm-12">
                                                    <div class="row" ng-if="group.phase_list.length != 0">
                                                        <div class="col-sm-12">
                                                            <div ng-repeat="step in group.phase_list"  class="cmpt-module">
                                                                <div style="padding-left: 15px;">
                                                                    <div class="cmpt-module-content">
                                                                        <div class="row cmpt-module-head" ng-class="step.show_detail ? 'cmpt-module-head-hover':''" ng-click="toggleModulesDetail(step, group)">
                                                                            <div class="col-sm-1" style="width: 20px;margin-right: 10px;">
                                                                                <div class="step-circle-common">
                                                                                    <span class="step-circle-font">{{step.phase_no}}</span>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-sm-1" style="padding-right: 0;">
                                                                                <span class="phase-type-img header-cmpt" ng-show="step.phase_type==1"></span>
                                                                                <span class="phase-type-img header-cmpt-check" ng-show="step.phase_type==2"></span>
                                                                                <span class="phase-type-img header-script" ng-show="step.phase_type==3"></span>
                                                                                <span class="phase-type-img header-solid-config" ng-show="step.phase_type==4"></span>
                                                                                <span class="phase-type-img header-custom-config" ng-show="step.phase_type==5"></span>
                                                                                <span class="phase-type-img header-handle-phase" ng-show="step.phase_type==6"></span>
                                                                            </div>
                                                                            <div class="col-sm-6" style="padding-left: 0;">
                                                                                <span class="cmpt-font" title="{{step.phase_name}}" >{{step.phase_name}}</span>
                                                                            </div>
                                                                            <div style="float: right;">
                                                                                <div ng-if="step.interactor_flag" title="交互式" class="cmpt-exec-method cmpt-exec-method-interact"></div>
                                                                                <div ng-if="step.parallel_flag" title="并行" class="cmpt-exec-method cmpt-exec-method-parallel"></div>
                                                                                <span ng-if="step.impl_type == 1" class="exec-type ftp-color">FTP</span>
                                                                                <span ng-if="step.impl_type == 2" class="exec-type shell-color">SHELL</span>
                                                                                <span ng-if="step.impl_type == 3" class="exec-type was-color">WAS</span>
                                                                                <span ng-if="step.impl_type == 4" class="exec-type svn-color">SVN</span>
                                                                                <span ng-if="step.impl_type == 5" class="exec-type weblogic-color">WEBLOGIC</span>
                                                                                <span ng-if="step.impl_type == 6" class="exec-type jdbc-color">SQL</span>
                                                                                <span ng-if="step.impl_type == 7" class="exec-type python-color">PYTHON2</span>
                                                                                <span ng-if="step.impl_type == 8" class="exec-type python-color">PYTHON3</span>
                                                                                <span ng-if="step.impl_type == 11" class="exec-type python-color">BAT</span>
                                                                                <span ng-if="step.impl_type == 14" class="exec-type java-color">JAVA</span>
                                                                                <span ng-if="step.impl_type == 15" class="exec-type c-color">C/C++</span>
                                                                                <span ng-if="step.impl_type == 17" class="exec-type c-color">CUSTOM</span>
                                                                                <span ng-if="step.impl_type == 18" class="exec-type cl-color">AS400_CL</span>
                                                                                <span ng-if="step.impl_type == 19" class="exec-type bgm-color">AS400_BGM</span>
                                                                            </div>
                                                                        </div>
                                                                        <!--phase_type 1 组件 2 校验组件 3 脚本 4 固化配置 5自定义配置 6 人工阶段-->
                                                                        <!-- 组件-->
                                                                        <div ng-if="step.phase_type ==1 || step.phase_type == 2 ">
                                                                            <div collapse="!step.show_detail" class="content-border">
                                                                                <div class="form-style container-fluid">
                                                                                    <div class="row" style="padding-top:20px;">
                                                                                        <div class="col-sm-3" style="text-align: right">
                                                                                            <label class="label-key">描述</label>
                                                                                        </div>
                                                                                        <div class="col-sm-9 label-value" style="margin-top:2px">
                                                                                            {{step.bk_desc}}
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="row" ng-if="step.impl_type == 15 || step.impl_type == 17" style="margin-top: 18px;padding-right:20px;">
                                                                                        <div class="col-sm-3" style="padding-right: 12px;text-align: right">
                                                                                            <label class="label-key">执行命令</label>
                                                                                        </div>
                                                                                        <div class="col-sm-9 label-value code-script-content" id="commandShell" custom-scroll>
                                                                                                <textarea
                                                                                                        ui-codemirror="viewOptions"
                                                                                                        ui-refresh="true"
                                                                                                        placeholder="执行命令"
                                                                                                        ng-model="step.command.exec_script"
                                                                                                >
                                                                                                </textarea>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="row" ng-if="step.impl_type != 15" style="margin-top: 18px;padding-right:20px;">
                                                                                        <div class="col-sm-3" style="padding-right: 12px;text-align: right">
                                                                                            <label class="label-key">执行脚本</label>
                                                                                        </div>
                                                                                        <div class="col-sm-9 label-value code-script-content" custom-scroll>
                                                                                                <textarea
                                                                                                        ui-codemirror="viewOptions"
                                                                                                        ui-refresh="true"
                                                                                                        placeholder="执行脚本"
                                                                                                        ng-model="step.exec_script"
                                                                                                >
                                                                                                </textarea>
                                                                                        </div>
                                                                                    </div>
                                                                                    <!--参数列表-->
                                                                                    <div class="row" style="padding-top: 10px;text-align: right">
                                                                                        <div class="col-sm-3">
                                                                                            <label class="label-key">组件参数</label>
                                                                                        </div>
                                                                                        <div class="col-sm-9 label-value" id="param_table" style="padding-left:10px;padding-right:35px;margin-top: 2px">
                                                                                            <div ng-show="!step.ref_param_list" style="color: #999;cursor: default;text-align: left;">暂无引用参数列表</div>
                                                                                            <table  ng-show="step.ref_param_list" class="sub-table" tbl-Data="step.ref_param_list">
                                                                                                <thead>
                                                                                                <tr >
                                                                                                    <td style="text-align: left">
                                                                                                        <span>参数名</span>
                                                                                                        <span><i style=" color: #FF6600; font-size: 10px;" class="fa fa-asterisk"></i></span>
                                                                                                    </td>
                                                                                                    <td style="text-align: left">
                                                                                                        引用全局参数
                                                                                                    </td>
                                                                                                    <td style="text-align: left">
                                                                                                        参数中文名
                                                                                                    </td>
                                                                                                </tr>
                                                                                                </thead>
                                                                                                <tbody >
                                                                                                <tr ng-repeat="tr in step.ref_param_list" style="font-size: 12px;">
                                                                                                    <td style="text-align: left;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;" ng-style="calculateWidth()" title="{{tr.param_name}}">{{tr.param_name}}</td>
                                                                                                    <td style="text-align: left;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;" ng-style="calculateWidth()" title="{{tr.ref}}">{{tr.ref}}</td>
                                                                                                    <td style="text-align: left;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;" ng-style="calculateWidth()" title="{{tr.param_cn_name}}">{{tr.param_cn_name ? tr.param_cn_name : '--'}}</td>
                                                                                                </tr>
                                                                                                </tbody>
                                                                                            </table>
                                                                                        </div>
                                                                                    </div>
                                                                                    <!-- 数据源 -->
                                                                                    <div class="row" >
                                                                                        <div class="col-sm-3 label-key" style="text-align: right;">
                                                                                            <label >执行节点</label>
                                                                                        </div>
                                                                                        <div class="col-sm-9 label-value" style="padding-left:10px;padding-right:35px;">
                                                                                            <span>{{step.logical_node ? step.logical_node.logical_node_name : '--'}}</span>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <!-- 脚本-->
                                                                        <div ng-if="step.phase_type ==3">
                                                                            <div collapse="!step.show_detail" class="content-border">
                                                                                <div class=" container-fluid">
                                                                                    <div  class="row form-style" ng-if="step.impl_type == 15 || step.impl_type == 17"  style="padding-right:20px;padding-top: 20px;">
                                                                                        <div class="col-sm-3" style="text-align: right;">
                                                                                            <label class="label-key">执行命令</label>
                                                                                        </div>
                                                                                        <div class="col-sm-9 code-script-content" id="commandShell2" custom-scroll>
                                                                                        <textarea name="subgroup_exec_script" disabled ui-codemirror="viewOptions" ui-refresh="true" ng-model="step.command.exec_script" class="form-control" placeholder="执行命令" style="resize:none;">
                                                                                    </textarea>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div  class="row form-style" ng-if="step.impl_type != 15"  style="padding-right:20px;padding-top: 20px;">
                                                                                        <div class="col-sm-3" style="text-align: right;">
                                                                                            <label class="label-key">执行脚本</label>
                                                                                        </div>
                                                                                        <div class="col-sm-9 code-script-content" custom-scroll>
                                                                                        <textarea name="subgroup_exec_script" disabled ui-codemirror="viewOptions" ui-refresh="true" ng-model="step.exec_script" class="form-control" placeholder="执行脚本" style="resize:none;">
                                                                                    </textarea>
                                                                                        </div>
                                                                                    </div>
                                                                                    <!--数据源-->
                                                                                    <div class="row form-style">
                                                                                        <div class="col-sm-3 label-key" style="text-align: right;">
                                                                                            <label>执行节点</label>
                                                                                        </div>
                                                                                        <div class="col-sm-9 label-value" style="padding-left:10px;padding-right:35px;">
                                                                                            <span>{{step.logical_node ? step.logical_node.logical_node_name : '--'}}</span>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <!--固化配置-->
                                                                        <div ng-if="step.phase_type == 4">
                                                                            <div collapse="!step.show_detail" class="content-border">
                                                                                <div style="padding: 20px 20px 5px">
                                                                                    <div ng-if="step.logical_node">
                                                                                        <div class="phase-soc-title">
                                                        <span class="soc-detail">
                                                            <span class="soc-proto" title="{{step.logical_node.logical_node_name}}">{{step.logical_node.logical_node_name}}</span>
                                                        </span>
                                                                                        </div>
                                                                                        <div class="config-files-list">
                                                                                            <div class="file-list" ng-repeat="file in step.logical_node.file_list" title="{{file}}">
                                                                                                <i class="fa fa-file-text-o"></i> {{file.substring(file.lastIndexOf('/')+1)}}
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div ng-if="!step.logical_node" class="none-color text-center" style="padding: 6px 0;">
                                                                                        暂无配置
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <!--自定义配置-->
                                                                        <div ng-if="step.phase_type == 5">
                                                                            <div collapse="!step.show_detail" class="content-border">
                                                                                <div>
                                                                                    <div class="row" style="padding-top: 18px;margin: 0 0 0 20px;padding-bottom: 10px">
                                                                                        <div class="col-sm-2 prog-content-tip"></div>
                                                                                        <div class="col-sm-8" style="font-size: 12px;margin-top: 10px;">
                                                                                            {{step.script.cmds[0]}}
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <!--人工阶段-->
                                                                        <div ng-if="step.phase_type == 6">
                                                                            <div collapse="!step.show_detail" class="content-border">
                                                                                <div>
                                                                                    <div class="row" style="padding-top: 18px;margin: 0 0 0 20px;padding-bottom: 10px">
                                                                                        <div class="col-sm-2 prog-content-tip"></div>
                                                                                        <div class="col-sm-8" style="font-size: 12px;margin-top: 10px;">
                                                                                            <div style="word-break: break-all;" ng-bind-html="step.url_detail"></div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="module-vertical-common-line" style="left: 31px;" ng-if="!$last"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <label class="control-label" style="color:#999999;padding-bottom: 10px" ng-if="group.phase_list.length == 0">暂未配置发布阶段信息</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="module-vertical-common-line" style="left: 22px;bottom: 0;height: 13px;" ng-if="!$last"></div>
                                    </div>
                                </div>
                            </div>
                            <!--参数信息-->
                            <div class="row">
                                <div class="col-sm-12">
                                    <table class="sub-table table">
                                        <thead>
                                        <tr>
                                            <td style="text-align: left;">
                                                参数名
                                            </td>
                                            <td style="text-align: left;">
                                                参数值
                                            </td>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr ng-repeat="tr in rollback_info.param_list track by $index" ng-if="tr.param_type !=3">
                                            <td  style="width: 125px;" title="{{tr.param_bk_desc ?  '参数描述:'+tr.param_bk_desc : ''}}">
                                                <span class="col-sm-7" style="text-align: left;;white-space: nowrap;text-overflow: ellipsis; overflow: hidden;padding: 0;" title="{{tr.param_name}}">{{tr.param_name}}</span>
                                                <span class="col-sm-5" style="color: #b1b1b1;white-space: nowrap;text-overflow: ellipsis; overflow: hidden;text-align: left;padding: 0;" title="{{tr.param_cn_name}}">{{tr.param_cn_name}}</span>
                                            </td>
                                            <td style="max-width: 380px;width: 340px;text-align: left;position: relative;padding-right: 25px;" title="{{tr.modify_flag == 2 ? '参数值不可修改':''}}">
                                                <div ng-if="tr.modify_flag == 2">
                                                    <span ng-if="!tr.sensitive_flag">{{tr.param_value}}</span>
                                                    <span ng-if="tr.sensitive_flag">******</span>
                                                </div>
                                                <div ng-if="tr.modify_flag != 2">
                                                 <textarea  name="pub_param_value{{$index}}"
                                                            ng-if="!tr.sensitive_flag"
                                                            ui-codemirror="{ onLoad : paramShellLoaded}"
                                                            ui-refresh="true"
                                                            ng-model="tr.param_value"
                                                            class="sub-form-control"
                                                            required>
                                                             </textarea>
                                                    <!--只是为了兼容360浏览器阻止默认密码填写-->
                                                    <input type="password" style="display: none;" disabled autocomplete = "new-password"/>
                                                    <input type="password"
                                                           ng-if="tr.sensitive_flag"
                                                           class="pass_input"
                                                           style="height: 26px;padding-left: 5px"
                                                           autocomplete="new-password"
                                                           ng-model="tr.label_param_value"
                                                           ng-init="tr.label_param_value =  tr.param_value ?  '1111111111' : ''"
                                                           disabled
                                                           required
                                                    />
                                                    <div style="position: absolute;top: 9px;right: 6px;cursor: pointer;">
                                                        <i ng-if="!tr.sensitive_flag" class="fa fa-eye" title="明文" ng-click="tr.sensitive_flag=true;tr.label_param_value = tr.param_value ? '1111111111' : ''"></i>
                                                        <i ng-if="tr.sensitive_flag" class="fa fa-eye-slash" title="密文" ng-click="tr.sensitive_flag=false"></i>
                                                    </div>
                                                    <validate-msg tag-cn-name="参数值" name="pub_param_value{{$index}}"></validate-msg>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr ng-if="control.param_list_flag">
                                            <td colspan="4" style="text-align: center;">
                                                暂无数据
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--准备回退按钮-->
        <div class="row" ng-show="rollback_info.group_list.length !=0" style="padding: 20px 0px;">
            <div class="col-sm-12 text-center" >
                <button  type="button" class="cancel-btn btn-xl" style="text-align:center;" ng-click="cancel();">
                    取消
                </button>
                <button ng-if="!control.btnBus_loading" type="button" class="save-btn btn-xl" style="text-align:center;" ng-click="saveRollbackInfo()">保存</button>
                <button ng-if="control.btnBus_loading" type="button" class="save-btn btn-xl">
                    <i style="color: white" class="fa fa-spinner fa-spin"></i>
                </button>
            </div>
        </div>
        <!--历史回退信息-->
        <div class="tag_position">
            <!--内容-->
            <div style="display: inline-block;top: 0;background: #191e26;width: 500px;height: 400px;margin-left: -4px;vertical-align: top;color: #808080;padding: 30px 20px;position: relative;">
                <!--箭头-->
                <div style="position: absolute;top:0;left: -70px;">
                    <div class="rollback_tag">
                        历史信息
                    </div>
                </div>
                <div style="max-height: 340px;overflow: hidden;overflow-y: auto;overflow-x:hidden ">
                    <div class="row" ng-repeat="single in data.rollback_info_list" style="margin-top: 20px">
                        <div class="col-sm-4">
                            <div style="float: left;height: 100%;margin-top: 18px">
                                <div class="temp-circle"></div>
                            </div>
                            <div style="float: left;margin-left: 10px" class="date-time">
                                <p class="date" style="margin-bottom: 0">{{single.start_bk_tm.substring(0,single.start_bk_tm.indexOf(' '))}}</p>
                                <p class="time">{{single.start_bk_tm.substring(single.start_bk_tm.indexOf(' ')+1,single.start_bk_tm.length-4)}}</p>
                            </div>
                            <div style="clear: both;"></div>
                        </div>
                        <div class="col-sm-8">
                            <div class="row">
                                <div class="col-sm-4">节点</div>
                                <div class="col-sm-8">
                                    <li style="list-style: none;float: left;margin-right: 10px" ng-repeat="node in single.node_ips">
                                        {{node}}
                                    </li>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4">回退方案</div>
                                <div class="col-sm-8">{{single.prog_cn_name}}</div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4">回退结果</div>
                                <div class="col-sm-8">
                                    <span ng-if="single.project_status == 7" class="status_img list_success_img"></span>
                                    <span ng-if="single.project_status == 8" class="status_img list_fail_img"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row text-center" ng-if="data.rollback_info_list.length == 0" style="height: 200px;line-height: 200px">
                        暂无历史回退信息
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>